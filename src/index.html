<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Pi-Talker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- vendor libraries -->
    <script src="vendor/jquery/dist/jquery.min.js"></script>


    <!-- stylesheets -->
    <link href="https://fonts.googleapis.com/css?family=VT323" rel="stylesheet">
    <link href="vendor/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="build/style.css" rel="stylesheet" type="text/css" />

    <script>
      'use strict';

      const ajaxErr = (res) => console.warn('There was an ERROR connecting to the Server: \n' + res);
      const alertTraceback = (trace) => { if (trace) alert(trace); };

      $(document).ready(function() {
        $("input[type='range']").on("change",
          function sendPOST(e) {
            $.ajax({
              url: "/",
              method: 'POST',
              data: $(this).serialize(),
              dataType: 'json',
              success: function(res) {
                $(e.target).parents('.row').find('.icon').toggleClass('active', res.status == 1);
                $(e.target).val(res.status);

                //alertTraceback(res.pyResponse.traceback);
              },
              error: function(res) {
                ajaxErr(res);
              }
            });
          }
        );

        $(".btn").on("click",
          function sendPOST(e) {
            e.preventDefault();

            $.ajax({
              url: "/",
              method: 'POST',
              data: { range: 1 },
              dataType: 'json',
              success: function(res) {
                $('#rangeResponse').text(JSON.stringify(res.pyResponse));

                //alertTraceback(res.pyResponse.traceback);
              },
              error: function(res) {
                ajaxErr(res);
              }
            });
          }
        );
      });
    </script>
  </head>
  <body>
      <div class="jumbotron text-center">
        <h1>Control Panel</h1>
      </div>
      <form>
        <div class="container-fluid">
          <div class="row">
            <span class="icon icon-light col-lg-2">
              <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
            </span>
            <label class="col-lg-8">Light 1</label>
            <span class="col-lg-2 ">
              <input type="range" min="0" max="1" value="0" name="light1" />
            </span>
          </div>
          <hr />
          <div class="row">
            <span class="icon icon-light col-lg-2">
              <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
            </span>
            <label class="col-lg-8">Light 2</label>
            <span class="col-lg-2">
              <input type="range" min="0" max="1" value="0" name="light2" />
            </span>
          </div>
          <hr />
          <div class="row">
            <span class="icon icon-plug col-lg-2">
              <i class="fa fa-plug" aria-hidden="true"></i>
            </span>
            <label class="col-lg-8">Outlet 1</label>
            <span class="col-lg-2">
              <input type="range" min="0" max="1" value="0" name="outlet1" />
            </span>
          </div>
          <hr />
          <div class="row">
            <div class="col-lg-10">
              <button class="btn btn-info" value="Range" style="font-size: 36px;">Return Range</button>
            </div>
            <span class="col-lg-2">
              <p id="rangeResponse"></p>
            </span>
          </div>
        </div>
      </form>
    </div>
  </body>
</html>
